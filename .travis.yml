sudo: required
dist: trusty
before_install:
- sudo apt-get -qq update
- sudo apt-get install -y lftp
install:
script:
- build/build.sh
- git add -A
- CHCONF=0
- CHNGFW=0
- CHANGE=0
- git diff-tree --quiet HEAD -r buckets/appframework-conf.zip || CHCONF=1
- git diff-tree --quiet HEAD -r buckets/appframework-ngfw.zip || CHNGFW=1
- git diff-index --quiet HEAD || CHANGE=1
- echo chconf=${CHCONF}
- echo chngfw=${CHNGFW}
- echo change=${CHANGE}
- if [[ "$CHANGE" == "1" ]]; then git commit -m 'autocommit travis[skip ci]'; fi
- if [[ "$CHANGE" == "1" ]]; then git push; fi
- if [[ "$CHNGFW" == "1" ]]; then cat build/lftp-ngfw.cmd  | sed "s/BOXUSER BOXPASSWORD/${BOX_USER} ${BOX_PASSWORD}/" | lftp; fi
- if [[ "$CHCONF" == "1" ]]; then cat build/lftp-conf.cmd  | sed "s/BOXUSER BOXPASSWORD/${BOXUSER} ${BOXPASSWORD}/" | lftp; fi

